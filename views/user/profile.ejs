<%- include("../partials/navbar") %>


<div class="flex min-h-screen bg-gray-100">
    <!-- Sidebar -->
    <%- include("../partials/profileSidebar") %>

    <!-- Main Content -->
    <div class="flex-1 py-12 px-6">
        <div class="max-w-3xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden">
            <div class="bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4">
                <h3 class="text-2xl font-bold text-white text-center">User Profile</h3>
            </div>
            <div class="p-6">
                <form id="profileForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="firstname" class="block text-sm font-medium text-gray-700">First Name</label>
                            <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" 
                                id="firstname" name="firstname" value="<%= user.firstname %>" required>
                        </div>
                        <div>
                            <label for="lastname" class="block text-sm font-medium text-gray-700">Last Name</label>
                            <input type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" 
                                id="lastname" name="lastname" value="<%= user.lastname %>" required>
                        </div>
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" class="mt-1 block w-full rounded-md border-gray-300 bg-gray-50 shadow-sm" 
                            id="email" value="<%= user.email %>" readonly>
                    </div>
                    <div>
                        <label for="status" class="block text-sm font-medium text-gray-700">Account Status</label>
                        <input type="text" class="mt-1 block w-full rounded-md border-gray-300 bg-gray-50 shadow-sm" 
                            id="status" value="<%= user.status %>" readonly>
                    </div>
                    <div class="flex justify-center">
                        <button type="submit" 
                            class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Update Profile
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('profileForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = {
        firstname: document.getElementById('firstname').value,
        lastname: document.getElementById('lastname').value
    };

    try {
        const response = await fetch('/profile/update', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        });

        const data = await response.json();
        
        if (data.success) {
            alert('Profile updated successfully!');
        } else {
            alert('Failed to update profile: ' + data.message);
        }
    } catch (error) {
        alert('An error occurred while updating the profile');
    }
});
</script>

<%- include('../partials/footer') %>
